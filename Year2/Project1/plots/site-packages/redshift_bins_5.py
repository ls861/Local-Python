
# =============================================================================
# Parameter vs redshift, in redshift bins, slope, intercept and scatter
# =============================================================================

def redshift_bins_5(rc_29_19_c1, rc_31_19_c2, rc_31_19_c3, rc_31_19_c4, rc_29_20_c1, rc_29_20_c2, rc_31_20_c3, rc_31_20_c4, rc_31_21_c1, rc_31_21_c2, rc_31_21_c3, rc_31_21_c4, figuresize, fontsize_legend, fontsize_axes, string_slope, string_normalisation, string_scatter, string_pbad, string_outlier_mean, string_outlier_sigma, string_redshift, save):
    
    import matplotlib.pyplot as plt
    import matplotlib as mpl
    
    fig = plt.figure(figsize=(2*figuresize, 1*figuresize))
    xlow = 0.3
    xhigh = 6.7
    
    param = ['alpha', 'beta', 'sig0', 'pbad', 'outlier_mean', 'outlier_sigma']
    
    ax1 = fig.add_axes([0, 2.5, 0.5, 0.5]) #[left, bottom, width, height]
    ax2 = fig.add_axes([0, 2.0, 0.5, 0.5]) #[left, bottom, width, height]
    ax3 = fig.add_axes([0, 1.5, 0.5, 0.5]) #[left, bottom, width, height]
    ax4 = fig.add_axes([0, 1.0, 0.5, 0.5]) #[left, bottom, width, height]
    ax5 = fig.add_axes([0, 0.5, 0.5, 0.5]) #[left, bottom, width, height]
    ax6 = fig.add_axes([0, 0.0, 0.5, 0.5]) #[left, bottom, width, height]
    
    axes = [ax1,ax2,ax3,ax4,ax5,ax6]
    
    for ax in axes:
        ax.set_xlim(xlow, xhigh)
        ax.xaxis.set_major_locator(mpl.ticker.MultipleLocator(1))
        ax.xaxis.set_minor_locator(mpl.ticker.MultipleLocator(0.5))
        ax.xaxis.set_tick_params(which='major', size=10, width=2, direction='in', bottom='on', top='on')
        ax.xaxis.set_tick_params(which='minor', size=5, width=2, direction='in', bottom='on', top='on')
        ax.yaxis.set_tick_params(which='major', size=10, width=2, direction='in', left='on', right='on')
        ax.yaxis.set_tick_params(which='minor', size=5, width=2, direction='in', left='on', right='on')
        ax.yaxis.set_tick_params(labelsize=fontsize_axes)
    
    # redshift bins
    for rc in [rc_29_19_c1, rc_31_19_c2, rc_31_19_c3, rc_31_19_c4]:
        for a, ax in enumerate(axes):
            ax.plot(rc.item().get('z'), rc.item().get('{}_50_arr'.format(param[a])), color='k', linestyle='dashed')
            # ax.fill_between(rc.item().get('z'), rc.item().get('{}_16_arr'.format(param[a])), rc.item().get('{}_84_arr'.format(param[a])), alpha=0.3, color='blue', zorder=0)

    for rc in [rc_29_20_c1, rc_29_20_c2, rc_31_20_c3, rc_31_20_c4]:
        for a, ax in enumerate(axes):
            ax.plot(rc.item().get('z'), rc.item().get('{}_50_arr'.format(param[a])), color='k')
            ax.fill_between(rc.item().get('z'), rc.item().get('{}_16_arr'.format(param[a])), rc.item().get('{}_84_arr'.format(param[a])), alpha=0.3, color='blue', zorder=0)

    for rc in [rc_31_21_c1, rc_31_21_c2, rc_31_21_c3, rc_31_21_c4]:
        for a, ax in enumerate(axes):
            ax.plot(rc.item().get('z'), rc.item().get('{}_50_arr'.format(param[a])), color='k', linestyle='dotted')
            # ax.fill_between(rc.item().get('z'), rc.item().get('{}_16_arr'.format(param[a])), rc.item().get('{}_84_arr'.format(param[a])), alpha=0.3, color='blue', zorder=0)
        
    # layout
    ylim_low = [0.9, 0.5, 0.01, -0.05, -9.99, 0.01]
    ylim_high = [1.9, 1.1, 0.79, 0.25, 9.99, 9.99]
    string = [string_normalisation, string_slope, string_scatter, string_pbad, string_outlier_mean, string_outlier_sigma]
    ticker_maj = [0.2, 0.2, 0.2, 0.1, 4.0, 2.0]
    ticker_min = [0.1, 0.1, 0.1, 0.05, 2.0, 1.0]
    for a, ax in enumerate(axes):
        ax.set_ylim(ylim_low[a], ylim_high [a])
        ax.set_ylabel(string[a], labelpad=10)
        ax.yaxis.set_major_locator(mpl.ticker.MultipleLocator(ticker_maj[a]))
        ax.yaxis.set_minor_locator(mpl.ticker.MultipleLocator(ticker_min[a]))
    
    ax6.set_xlabel(string_redshift, labelpad=10)
    ax6.xaxis.set_tick_params(labelsize=fontsize_axes)
    
    ax6.plot(0, 0, color='k', linestyle='dashed', label='run 19')
    ax6.plot(0, 0, color='k', label='run 20')
    ax6.plot(0, 0, color='k', linestyle='dotted', label='run 21')
    ax6.legend(loc='lower right', frameon=False, fontsize=fontsize_legend)
    
    if save:
        plt.savefig('redshift_bins_1.png', dpi=300, transparent=False, bbox_inches='tight')
    plt.show()