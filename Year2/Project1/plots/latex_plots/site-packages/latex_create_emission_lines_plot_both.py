#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Wed Jul 28 09:50:07 2021

@author: lester
"""


import numpy as np
import matplotlib.pyplot as plt
import matplotlib
matplotlib.rcParams.update({'font.size': 10})

### FILTERS ###
# filter_label = np.array(['B435', 'V606', 'I814', 'Y105', 'J125', 'JH140', 'H160', 'Ks', 'CH1', 'CH2'])
# filter_fwhm_centre = np.array([4348.65, 5926.47, 7975.65, 10530.87, 12495.71, 13976.13, 15433.07, 21440.35, 35465.62, 45024.31])
# filter_fwhm = np.array([939, 2322.94, 1856, 2917.03, 3005.2, 3940.88, 2874.18, 3249.92, 7431.71, 10096.82])

### updated labels, but not sure where values are from?!###
# filter_label = np.array(['B435', 'V606', 'I814', 'Y105', 'J125', 'H160', 'Ks', 'CH1', 'CH2'])
# filter_label = ['F435W', 'F606W', 'F814W', 'F105W', 'F125W', 'F160W', 'Ks', r'IRAC 3.6 $\mu m$', r'IRAC 4.5 $\mu m$']
# filter_fwhm_centre = np.array([4348.65, 5926.47, 7975.65, 10530.87, 12495.71, 15433.07, 21440.35, 35465.62, 45024.31])
# filter_fwhm = np.array([939.00, 2322.94, 1856, 2917.03, 3005.2, 2874.18, 3249.92, 7431.71, 10096.82])

### updated labels, values from ###
# http://svo2.cab.inta-csic.es/svo/theory/fps3/index.php?mode=browse&gname=HST&gname2=ACS_WFC&asttype=
# http://svo2.cab.inta-csic.es/svo/theory/fps3/index.php?&mode=browse&gname=HST&gname2=WFC3_IR
# http://svo2.cab.inta-csic.es/svo/theory/fps3/index.php?mode=browse&gname=Paranal&gname2=HAWKI&asttype=
# http://svo2.cab.inta-csic.es/svo/theory/fps3/index.php?mode=browse&gname=Spitzer&gname2=IRAC&asttype=
filter_label = ['F435W', 'F606W', 'F814W', 'F105W', 'F125W', 'F140W', 'F160W', 'Ks', r'IRAC 3.6 $\mu m$', r'IRAC 4.5 $\mu m$']
filter_fwhm_centre = np.array([4349.62, 5926.48, 7976.86, 10530.87, 12495.71, 13976.13, 15433.07, 21440.35, 35465.62, 45024.31])
filter_fwhm = np.array([937.14, 2322.93, 1858.35, 2917.03, 3005.20, 3940.88, 2874.18, 3249.92, 7431.71, 10096.82])

# NIRCAM JADES WIDE
# http://svo2.cab.inta-csic.es/svo/theory/fps3/index.php?mode=browse&gname=JWST&gname2=NIRCam&asttype=
filter_label0 = ['F070W','F090W','F115W','F150W','F200W','F277W','F356W','F444W']
filter_fwhm_centre0 = np.array([7099.19,9007.24,11494.31,15010.69,19920.76,27762.83,35652.16,44405.49])
filter_fwhm0 = np.array([1430.81,2088.06,2644.25,3349.30,4689.40,7064.64,8326.81,11144.05])

# NIRCAM JADES MEDIUM
# http://svo2.cab.inta-csic.es/svo/theory/fps3/index.php?mode=browse&gname=JWST&gname2=NIRCam&asttype=
filter_label1 = ['F335M','F410M']
filter_fwhm_centre1 = np.array([33593.66, 40848.60])
filter_fwhm1 = np.array([3576.00, 4351.65])

# HST ACS (from AD HFF)
# http://svo2.cab.inta-csic.es/svo/theory/fps3/index.php?mode=browse&gname=HST&gname2=ACS_WFC&asttype=
filter_label2 = ['F435W', 'F606W', 'F814W']
filter_fwhm_centre2 = np.array([4349.62, 5926.48, 7976.86])
filter_fwhm2 = np.array([937.14, 2322.93, 1858.35])

# JWST Proposal 1963
# http://svo2.cab.inta-csic.es/svo/theory/fps3/index.php?mode=browse&gname=JWST&gname2=NIRCam&asttype=
filter_label3 = ['F182M', 'F210M', 'F430M', 'F460M', 'F480M']
filter_fwhm_centre3 = np.array([18451.44, 20970.26, 42832.58, 46317.87, 48224.88])
filter_fwhm3 = np.array([2450.05, 2092.96, 2315.31, 2329.56, 3197.45])



left_edges = filter_fwhm_centre - (filter_fwhm / 2.0)
right_edges = filter_fwhm_centre + (filter_fwhm / 2.0)

left_edges0 = filter_fwhm_centre0 - (filter_fwhm0 / 2.0)
right_edges0 = filter_fwhm_centre0 + (filter_fwhm0 / 2.0)

left_edges1 = filter_fwhm_centre1 - (filter_fwhm1 / 2.0)
right_edges1 = filter_fwhm_centre1 + (filter_fwhm1 / 2.0)

left_edges2 = filter_fwhm_centre2 - (filter_fwhm2 / 2.0)
right_edges2 = filter_fwhm_centre2 + (filter_fwhm2 / 2.0)

left_edges3 = filter_fwhm_centre3 - (filter_fwhm3 / 2.0)
right_edges3 = filter_fwhm_centre3 + (filter_fwhm3 / 2.0)

### EMISSION LINES ###
line_wl = np.array([912.0, 1025.73, 1215.67, 1548.19, 1908.73, 3646.0, 3729.23, 4101.74, 4340.47, 4861.33, 5006.84, 6548.05, 6562.82, 6583.45, 6730.82])
line_label = np.array(['LyBREAK', 'HLyB@1026', 'HLyA@1216','C4@1548','C3@1910','BaBREAK', 'O2@3729', 'HBaD@4102', 'HBaG@4340', 'HBaB@4861', 'O3@5007', 'N2@6548', 'HBaA@6563', 'N2@6584', 'S2@6731'])

z_lower = 0
z_upper = 6
z_tmp = np.linspace(z_lower, z_upper, 1000)


import matplotlib as mpl
mpl.rcParams.update(mpl.rcParamsDefault)


#%%

# =============================================================================
# FOR PAPER
# =============================================================================

### EMISSION LINES ###
line_wl = np.array([912.0, 1215.67, 3646.0, 3729.23, 4861.33, 5006.84, 6562.82])
# line_label = np.array(['Lyman Break', r'$\mathrm{Ly}\alpha$','Balmer Break', r'$[\mathrm{O_{II}}]\lambda\lambda3726\mathrm{\AA}3729\mathrm{\AA}$', r'$\mathrm{H}\beta$', r'$[\mathrm{O_{III}}]\lambda5007\mathrm{\AA}$', r'$\mathrm{H}\alpha$'])
line_label = np.array(['Lyman Break', r'$\mathrm{Ly}\alpha$','Balmer Break', r'$[\mathrm{O_{II}}]$', r'$\mathrm{H}\beta$', r'$[\mathrm{O_{III}}]$', r'$\mathrm{H}\alpha$'])

# \newcommand{\oii}{\hbox{$[\txn{O}\textsc{ii}]\lambda\lambda3726\txn{\AA},3729\txn{\AA}$}}
# \newcommand{\oiii}{\hbox{$[\txn{O}\textsc{iii}]\lambda5007\txn{\AA}$}}
# \newcommand{\Hb}{\hbox{$\mathrm{H}\beta$}}
# \newcommand{\Ha}{\hbox{$\mathrm{H}\alpha$}}


# Edit the font, font size, and axes width
mpl.rcParams['font.family'] = 'Arial'
mpl.rc('image', cmap='jet')
cmap = mpl.cm.get_cmap('jet')
plt.rcParams['font.size'] = 24
plt.rcParams['axes.linewidth'] = 2
plt.rcParams['text.usetex'] = False
# plt.rcParams['text.usetex'] = True

figuresize = 7
fontsize_legend = 12
fontsize_axes = 20

cmap = plt.get_cmap("tab10")
# patterns = ['', '', '', '.', '', '', '', '', '']
patterns = ['', '', '', '', '', '', '', '', '']

fig = plt.figure(figsize=(3*figuresize, figuresize))

ax1 = fig.add_axes([0, 0.9, 0.85, 0.84]) #[left, bottom, width, height]

# FILTERS
for i in range(len(left_edges)):
    ii = i
    if i==5:
        ax1.fill_betweenx(z_tmp, left_edges[i]/(1+z_tmp), right_edges[i]/(1+z_tmp), alpha=0.4, hatch='o', color=cmap(ii), linewidth=0, label=filter_label[i])

    else:
        # ax.fill_betweenx(z_tmp, left_edges[i]/(1+z_tmp), right_edges[i]/(1+z_tmp), alpha=0.4, color=cmap(ii), hatch=patterns[i], label=filter_label[i])
        ax1.fill_betweenx(z_tmp, left_edges[i]/(1+z_tmp), right_edges[i]/(1+z_tmp), alpha=0.4, hatch='', color=cmap(ii), linewidth=0, label=filter_label[i])


for i in range(len(left_edges)):
    for j in range(len(line_wl)):

        if i > 6:
            z_fill = np.linspace((left_edges[i]/line_wl[j])-1, (right_edges[i]/line_wl[j])-1, 100)
            ax1.fill_betweenx(z_fill, left_edges[i]/(1+z_fill), right_edges[i]/(1+z_fill), alpha=1.0, hatch='xx', color='k', facecolor="none", linewidth=0)


for i in range(len(line_wl)):
    if i in [0, 2]: # LyBreak HBreak
        ax1.plot((line_wl[i], line_wl[i]), (z_lower, z_upper), color='k', lw=5, linestyle='dashed')
    elif i in [1, 4, 6]: # LyA HB HA
        ax1.plot((line_wl[i], line_wl[i]), (z_lower, z_upper), color='k', lw=5)
    elif i in [3, 5]: # OII OIII
        ax1.plot((line_wl[i], line_wl[i]), (z_lower, z_upper), color='k', lw=5)



    if i == 0:
        ax1.text(line_wl[i]-200, z_upper-4.0, line_label[i], color='k', rotation=90)
    elif i == 2:
        ax1.text(line_wl[i]-200, z_upper-4.0, line_label[i], color='k', rotation=90)

    elif i == 3:
        ax1.text(line_wl[i]-150, z_upper+0.2, line_label[i], color='k')
    elif i == 5: # OIII
        ax1.text(line_wl[i]-50, z_upper+0.2, line_label[i], color='k')

    elif i == 1:
        ax1.text(line_wl[i]-150, z_upper+0.2, line_label[i], color='k')
    elif i == 4: # HB
        ax1.text(line_wl[i]-250, z_upper+0.2, line_label[i], color='k')
    elif i == 6:
        ax1.text(line_wl[i]-150, z_upper+0.2, line_label[i], color='k')

# =============================================================================
# BASICS
# =============================================================================
ax1.set_xlim(0, 9000)
# ax1.set_xlabel(r'Rest-frame $\lambda \, / \, \mathrm{\AA}$', labelpad=10)
# ax.xaxis.set_major_locator(mpl.ticker.MultipleLocator(1))
# ax.xaxis.set_minor_locator(mpl.ticker.MultipleLocator(0.5))
ax1.xaxis.set_tick_params(which='major', size=0, width=2, direction='out', bottom='on')
ax1.xaxis.set_tick_params(which='minor', size=0, width=2, direction='out', bottom='on')
ax1.xaxis.set_tick_params(labelsize=0)

ax1.set_ylim(1.25, 6)
ax1.set_ylabel(r'$\mathrm{Redshift}$', labelpad=10)
# ax.yaxis.set_major_locator(mpl.ticker.MultipleLocator(1))
# ax.yaxis.set_minor_locator(mpl.ticker.MultipleLocator(0.5))
ax1.yaxis.set_tick_params(which='major', size=10, width=2, direction='out', left='on')
ax1.yaxis.set_tick_params(which='minor', size=5, width=2, direction='out', left='on')
ax1.yaxis.set_tick_params(labelsize=fontsize_axes)

# ax.legend(loc='lower right', frameon=True, fontsize=fontsize_legend, facecolor='w', framealpha=1)

ax1.legend(loc=(1.04,0.), fontsize=20, title="This Work")





ax2 = fig.add_axes([0, 0, 0.85, 0.84]) #[left, bottom, width, height]

# NIRCAM JADES WIDE
for i in range(len(left_edges0)):
    ii = i
    ax2.fill_betweenx(z_tmp, left_edges0[i]/(1+z_tmp), right_edges0[i]/(1+z_tmp), alpha=0.4, hatch='', color=cmap(ii), linewidth=0, label=filter_label0[i])

# NIRCAM JADES MEDIUM
for i in range(len(left_edges1)):
    if i == 0:
        ii = 6
    elif i == 1:
        ii = 7
    ax2.fill_betweenx(z_tmp, left_edges1[i]/(1+z_tmp), right_edges1[i]/(1+z_tmp), alpha=0.4, hatch='o', color=cmap(ii), linewidth=0, label=filter_label1[i])

# NIRCAM JADES MEDIUM
# for i in range(len(left_edges1)):
#     ax.fill_betweenx(z_tmp, left_edges1[i]/(1+z_tmp), right_edges1[i]/(1+z_tmp), alpha=1.0, hatch='xx', color='k', facecolor="none", linewidth=0, label=filter_label1[i])


# HST ACS (from AD HFF)
# for i in range(len(left_edges2)):
#     ax.fill_betweenx(z_tmp, left_edges2[i]/(1+z_tmp), right_edges2[i]/(1+z_tmp), alpha=1.0, hatch='', color='lightgrey', linewidth=0, label=filter_label2[i], zorder=0)

# JWST Proposal 1963
# for i in range(len(left_edges3)):
#     ax.fill_betweenx(z_tmp, left_edges3[i]/(1+z_tmp), right_edges3[i]/(1+z_tmp), alpha=1.0, hatch='x', color='k', facecolor="none", linewidth=0, label=filter_label3[i])

'''
for i in range(len(left_edges)):
    for j in range(len(line_wl)):

        if i > 5:
            z_fill = np.linspace((left_edges[i]/line_wl[j])-1, (right_edges[i]/line_wl[j])-1, 100)
            ax.fill_betweenx(z_fill, left_edges[i]/(1+z_fill), right_edges[i]/(1+z_fill), alpha=1.0, hatch='xx', color='k', facecolor="none", linewidth=0)
'''

for i in range(len(line_wl)):
    if i in [0, 2]: # LyBreak HBreak
        ax2.plot((line_wl[i], line_wl[i]), (z_lower, z_upper), color='k', lw=5, linestyle='dashed')
    elif i in [1, 4, 6]: # LyA HB HA
        ax2.plot((line_wl[i], line_wl[i]), (z_lower, z_upper), color='k', lw=5)
    elif i in [3, 5]: # OII OIII
        ax2.plot((line_wl[i], line_wl[i]), (z_lower, z_upper), color='k', lw=5)



    if i == 0:
        ax2.text(line_wl[i]-200, z_upper-4.0, line_label[i], color='k', rotation=90)
    elif i == 2:
        ax2.text(line_wl[i]-200, z_upper-4.0, line_label[i], color='k', rotation=90)

    # elif i == 3:
    #     ax2.text(line_wl[i]-150, z_upper+0.2, line_label[i], color='k')
    # elif i == 5: # OIII
    #     ax2.text(line_wl[i]-50, z_upper+0.2, line_label[i], color='k')
    #
    # elif i == 1:
    #     ax2.text(line_wl[i]-150, z_upper+0.2, line_label[i], color='k')
    # elif i == 4: # HB
    #     ax2.text(line_wl[i]-250, z_upper+0.2, line_label[i], color='k')
    # elif i == 6:
    #     ax2.text(line_wl[i]-150, z_upper+0.2, line_label[i], color='k')

# =============================================================================
# BASICS
# =============================================================================
ax2.set_xlim(0, 9000)
ax2.set_xlabel(r'Rest-frame $\lambda \, / \, \mathrm{\AA}$', labelpad=10)
# ax.xaxis.set_major_locator(mpl.ticker.MultipleLocator(1))
# ax.xaxis.set_minor_locator(mpl.ticker.MultipleLocator(0.5))
ax2.xaxis.set_tick_params(which='major', size=10, width=2, direction='out', bottom='on')
ax2.xaxis.set_tick_params(which='minor', size=5, width=2, direction='out', bottom='on')
ax2.xaxis.set_tick_params(labelsize=fontsize_axes)

ax2.set_ylim(1.25, 6)
ax2.set_ylabel(r'$\mathrm{Redshift}$', labelpad=10)
# ax.yaxis.set_major_locator(mpl.ticker.MultipleLocator(1))
# ax.yaxis.set_minor_locator(mpl.ticker.MultipleLocator(0.5))
ax2.yaxis.set_tick_params(which='major', size=10, width=2, direction='out', left='on')
ax2.yaxis.set_tick_params(which='minor', size=5, width=2, direction='out', left='on')
ax2.yaxis.set_tick_params(labelsize=fontsize_axes)

# ax.legend(loc='lower right', frameon=True, fontsize=fontsize_legend, facecolor='w', framealpha=1)

ax2.legend(loc=(1.04,0.), fontsize=20, title="JWST JADES")

# ax.grid(axis = 'y')



save=True

if save:
    plt.savefig('emission_lines.png', dpi=300, transparent=False, bbox_inches='tight')
plt.show()
